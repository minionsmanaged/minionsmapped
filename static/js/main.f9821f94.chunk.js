(this.webpackJsonpminionsmapped=this.webpackJsonpminionsmapped||[]).push([[0],{27:function(e,t,n){e.exports=n(42)},32:function(e,t,n){},38:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(24),i=n.n(r),s=(n(32),n(17)),c=n(21),l=n(9),u=n(10),h=n(13),p=n(11),f=n(6),m=n(12),k=n(26),d=n(20),w=n(8),g=n(15),v=n(7),y=n(19),b=n(14);Date.prototype.addHours=function(e){return this.setHours(this.getHours()+e),this};var P=function(e){function t(e){var n;Object(l.a)(this,t);var o=(n=Object(h.a)(this,Object(p.a)(t).call(this,e))).props.pool.workerPoolId.split("/");return n.state={instances:[],pending:0,domain:o.length>0?o[0]:"",pool:o.length>1?o[1]:""},n.queryTaskcluster=n.queryTaskcluster.bind(Object(f.a)(n)),n}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.queryTaskcluster()}},{key:"queryTaskcluster",value:function(){var e=this,t=[];fetch("https://firefox-ci-tc.services.mozilla.com/api/queue/v1/provisioners/"+this.state.domain+"/worker-types/"+this.state.pool+"/workers").then((function(e){return e.json()})).then((function(n){t=t.concat(n.workers),e.setState({instances:t}),"continuationToken"in n&&t.length<e.props.pool.config.maxCapacity&&fetch("https://firefox-ci-tc.services.mozilla.com/api/queue/v1/provisioners/"+e.state.domain+"/worker-types/"+e.state.pool+"/workers?continuationToken="+n.continuationToken).then((function(e){return e.json()})).then((function(n){t=t.concat(n.workers),e.setState({instances:t}),"continuationToken"in n&&t.length<e.props.pool.config.maxCapacity&&fetch("https://firefox-ci-tc.services.mozilla.com/api/queue/v1/provisioners/"+e.state.domain+"/worker-types/"+e.state.pool+"/workers?continuationToken="+n.continuationToken).then((function(e){return e.json()})).then((function(n){t=t.concat(n.workers),e.setState({instances:t}),"continuationToken"in n&&t.length<e.props.pool.config.maxCapacity&&fetch("https://firefox-ci-tc.services.mozilla.com/api/queue/v1/provisioners/"+e.state.domain+"/worker-types/"+e.state.pool+"/workers?continuationToken="+n.continuationToken).then((function(e){return e.json()})).then((function(n){t=t.concat(n.workers),e.setState({instances:t})}))}))}))})),fetch("https://firefox-ci-tc.services.mozilla.com/api/queue/v1/pending/"+this.state.domain+"/"+this.state.pool).then((function(e){return e.json()})).then((function(t){var n=t.pendingTasks;e.setState({pending:n})}))}},{key:"renderProviderIcon",value:function(){switch(this.props.pool.providerId){case"aws":return a.a.createElement(v.a,{icon:b.a});case"azure":return a.a.createElement(v.a,{icon:b.c});case"null-provider":return a.a.createElement(v.a,{icon:y.b});default:return this.props.pool.providerId.endsWith("-gcp")?a.a.createElement(v.a,{icon:b.b}):a.a.createElement(v.a,{icon:y.a})}}},{key:"render",value:function(){return a.a.createElement("li",{key:this.props.pool.workerPoolId},a.a.createElement("span",{className:"fa-li"},this.renderProviderIcon()),a.a.createElement("strong",null,this.state.pool),a.a.createElement("span",{style:{fontSize:"80%"}},"\xa0max: ",this.props.pool.config.maxCapacity,", \xa0working: ",this.state.instances.filter((function(e){return"latestTask"in e&&"firstClaim"in e})).length,", \xa0initialising: ",this.state.instances.filter((function(e){return(!("latestTask"in e)||!("firstClaim"in e))&&new Date(e.firstClaim)>(new Date).addHours(-1)})).length,", \xa0pending: ",this.state.pending),a.a.createElement("br",null),a.a.createElement(g.a,null,a.a.createElement(g.a,{striped:!0,variant:"success",now:Math.min(this.props.pool.config.maxCapacity,this.state.instances.filter((function(e){return"latestTask"in e&&"firstClaim"in e})).length),max:this.props.pool.config.maxCapacity,key:1}),a.a.createElement(g.a,{striped:!0,now:Math.min(this.props.pool.config.maxCapacity,this.state.instances.filter((function(e){return(!("latestTask"in e)||!("firstClaim"in e))&&new Date(e.firstClaim)>(new Date).addHours(-1)})).length),max:this.props.pool.config.maxCapacity,key:2})))}}]),t}(o.Component),C=(n(38),function(e){function t(){var e;return Object(l.a)(this,t),(e=Object(h.a)(this,Object(p.a)(t).call(this))).state={domains:[],pools:{},showAwsPools:!0,showAzurePools:!0,showGooglePools:!0},e.queryTaskcluster=e.queryTaskcluster.bind(Object(f.a)(e)),e.handleFilterChange=e.handleFilterChange.bind(Object(f.a)(e)),e}return Object(m.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.queryTaskcluster()}},{key:"queryTaskcluster",value:function(){var e=this,t=[];fetch("https://firefox-ci-tc.services.mozilla.com/api/worker-manager/v1/worker-pools").then((function(e){return e.json()})).then((function(n){var o=(t=t.concat(n.workerPools)).map((function(e){return e.workerPoolId.split("/")[0]})).filter((function(e,t,n){return n.indexOf(e)===t})),a=Object.assign.apply(Object,[{}].concat(Object(c.a)(o.map((function(e){return Object(s.a)({},e,t.filter((function(t){return t.workerPoolId.startsWith(e+"/")})))})))));e.setState({domains:o,pools:a}),"continuationToken"in n&&fetch("https://firefox-ci-tc.services.mozilla.com/api/worker-manager/v1/worker-pools?continuationToken="+n.continuationToken).then((function(e){return e.json()})).then((function(n){t=t.concat(n.workerPools),o=t.map((function(e){return e.workerPoolId.split("/")[0]})).filter((function(e,t,n){return n.indexOf(e)===t})),a=Object.assign.apply(Object,[{}].concat(Object(c.a)(o.map((function(e){return Object(s.a)({},e,t.filter((function(t){return t.workerPoolId.startsWith(e+"/")})))}))))),e.setState({domains:o,pools:a})}))}))}},{key:"renderPoolSummaryComponent",value:function(e){switch(e.providerId){case"aws":return this.state.showAwsPools?a.a.createElement(P,{pool:e,key:e.workerPoolId}):"";case"azure":return this.state.showAzurePools?a.a.createElement(P,{pool:e,key:e.workerPoolId}):"";case"null-provider":return a.a.createElement(P,{pool:e,key:e.workerPoolId});default:return e.providerId.endsWith("-gcp")?this.state.showGooglePools?a.a.createElement(P,{pool:e,key:e.workerPoolId}):"":a.a.createElement(P,{pool:e,key:e.workerPoolId})}}},{key:"handleFilterChange",value:function(e){switch(e.target.id){case"filterAws":this.setState((function(e){return{showAwsPools:!e.showAwsPools}}));break;case"filterAzure":this.setState((function(e){return{showAzurePools:!e.showAzurePools}}));break;case"filterGoogle":this.setState((function(e){return{showGooglePools:!e.showGooglePools}}))}}},{key:"render",value:function(){var e=this;return a.a.createElement(k.a,null,a.a.createElement(d.a,null,a.a.createElement(w.a,null,a.a.createElement(w.a.Check,{inline:!0,type:"checkbox",onChange:this.handleFilterChange,checked:this.state.showAwsPools,label:"aws",id:"filterAws"}),a.a.createElement(w.a.Check,{inline:!0,type:"checkbox",onChange:this.handleFilterChange,checked:this.state.showAzurePools,label:"azure",id:"filterAzure"}),a.a.createElement(w.a.Check,{inline:!0,type:"checkbox",onChange:this.handleFilterChange,checked:this.state.showGooglePools,label:"google",id:"filterGoogle"}))),a.a.createElement(d.a,null,a.a.createElement("ul",null,this.state.domains.map((function(t){return a.a.createElement("li",{key:t},t,a.a.createElement("ul",{className:"fa-ul"},e.state.pools[t].map((function(t){return e.renderPoolSummaryComponent(t)}))))})))))}}]),t}(o.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(41);i.a.render(a.a.createElement(C,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[27,1,2]]]);
//# sourceMappingURL=main.f9821f94.chunk.js.map